

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tutorial &mdash; QuantumOptics.jl</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="QuantumOptics.jl" href="../index.html"/>
        <link rel="next" title="Documentation" href="../documentation/documentation.html"/>
        <link rel="prev" title="Installation" href="../installation.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> QuantumOptics.jl
          

          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#bases">Bases</a></li>
<li class="toctree-l2"><a class="reference internal" href="#states-and-operators">States and Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="#composite-systems">Composite systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="#time-evolution">Time evolution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../documentation/documentation.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">QuantumOptics.jl</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Tutorial</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorial/tutorial.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tutorial">
<span id="id1"></span><h1>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial we will step through the common tasks necessary to simulate a quantum system. At each step links to documentation and examples will be provided that explain the topic at hand in more detail.</p>
<p>In order to use the <strong>QuantumOptics.jl</strong> library it has to be loaded into the current workspace.</p>
<div class="highlight-julia"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="n">QuantumOptics</span>
</pre></div>
</div>
<div class="section" id="bases">
<h2>Bases<a class="headerlink" href="#bases" title="Permalink to this headline">¶</a></h2>
<p>The first step is always to define a suitable basis for the quantum system under consideration. For example a Fock basis can be used to describe a field mode. It takes an integer as argument which specifies the photon number cutoff.</p>
<div class="highlight-julia"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">FockBasis</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
<p>Many common quantum systems are already implemented:</p>
<ul class="simple">
<li><a class="reference internal" href="../documentation/quantumsystems/spin.html#section-spin"><span class="std std-ref">Spin</span></a></li>
<li><a class="reference internal" href="../documentation/quantumsystems/fock.html#section-fock"><span class="std std-ref">Fock Basis</span></a></li>
<li><a class="reference internal" href="../documentation/quantumsystems/particle.html#section-particle"><span class="std std-ref">Particle</span></a></li>
<li><a class="reference internal" href="../documentation/quantumsystems/nlevel.html#section-nlevel"><span class="std std-ref">N-Level system</span></a></li>
<li><a class="reference internal" href="../documentation/quantumsystems/manybody.html#section-manybody"><span class="std std-ref">Many-body system</span></a></li>
</ul>
</div>
<div class="section" id="states-and-operators">
<h2>States and Operators<a class="headerlink" href="#states-and-operators" title="Permalink to this headline">¶</a></h2>
<p>Most of the typical operators and states in these bases are defined.</p>
<div class="highlight-julia"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">destroy</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="n">at</span> <span class="o">=</span> <span class="n">create</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">psi</span> <span class="o">=</span> <span class="n">coherentstate</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
</pre></div>
</div>
<p>These objects can be combined using standard arithmetic operations.</p>
<div class="highlight-julia"><div class="highlight"><pre><span></span><span class="n">dpsi</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="nb">im</span><span class="o">*</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">at</span><span class="p">)</span><span class="o">*</span><span class="n">psi</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../api.html#dagger-6b9c3a8f00a417219387096ca9c27460" title="dagger()"><code class="xref jl jl-func docutils literal"><span class="pre">dagger()</span></code></a> function can be used to transform a ket state into a bra state which for example can be used to create a density operator</p>
<div class="highlight-julia"><div class="highlight"><pre><span></span><span class="n">rho</span> <span class="o">=</span> <span class="n">psi</span> <span class="n">⊗</span> <span class="n">dagger</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
</pre></div>
</div>
<p>or to calculate expectation values</p>
<div class="highlight-julia"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">println</span><span class="p">(</span><span class="n">dagger</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">psi</span><span class="p">)</span>
<span class="mf">1.4999999999991955</span> <span class="o">+</span> <span class="mf">0.0</span><span class="nb">im</span>
</pre></div>
</div>
<p>Alternatively, the <a class="reference internal" href="../api.html#expect-6b154ee4358df5d6085dbc9445db0d4b" title="expect()"><code class="xref jl jl-func docutils literal"><span class="pre">expect()</span></code></a> function can be used which is faster and also directly extends to the case where the state is not a ket but a density operator.</p>
<div class="highlight-julia"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">println</span><span class="p">(</span><span class="n">expect</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">psi</span><span class="p">))</span>
<span class="mf">1.4999999999991955</span> <span class="o">+</span> <span class="mf">0.0</span><span class="nb">im</span>
</pre></div>
</div>
</div>
<div class="section" id="composite-systems">
<h2>Composite systems<a class="headerlink" href="#composite-systems" title="Permalink to this headline">¶</a></h2>
<p>Most interesting quantum systems consist of several different parts, for example a spin coupled to a cavity mode.</p>
<div class="highlight-julia"><div class="highlight"><pre><span></span><span class="n">ω_atom</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">ω_field</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c"># 2 level atom described as spin</span>
<span class="n">b_spin</span> <span class="o">=</span> <span class="n">SpinBasis</span><span class="p">(</span><span class="mi">1</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sp</span> <span class="o">=</span> <span class="n">sigmap</span><span class="p">(</span><span class="n">b_spin</span><span class="p">)</span>
<span class="n">sm</span> <span class="o">=</span> <span class="n">sigmam</span><span class="p">(</span><span class="n">b_spin</span><span class="p">)</span>

<span class="n">H_atom</span> <span class="o">=</span> <span class="n">ω_atom</span><span class="o">*</span><span class="n">sp</span><span class="o">*</span><span class="n">sm</span>

<span class="c"># Use a Fock basis with a maximum of 20 photons to model a cavity mode</span>
<span class="n">b_fock</span> <span class="o">=</span> <span class="n">FockBasis</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">destroy</span><span class="p">(</span><span class="n">b_fock</span><span class="p">)</span>
<span class="n">at</span> <span class="o">=</span> <span class="n">create</span><span class="p">(</span><span class="n">b_fock</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">number</span><span class="p">(</span><span class="n">b_fock</span><span class="p">)</span>

<span class="n">H_field</span> <span class="o">=</span> <span class="n">ω_field</span><span class="o">*</span><span class="n">n</span>
</pre></div>
</div>
<p>Combining operators from those two systems can be done with the <a class="reference internal" href="../api.html#tensor-19ab65e3c5e281716c25d7f49b3f383e" title="tensor()"><code class="xref jl jl-func docutils literal"><span class="pre">tensor()</span></code></a> function or with the equivalent <span class="math">\(\otimes\)</span> operator.</p>
<div class="highlight-julia"><div class="highlight"><pre><span></span><span class="n">Ω</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">H_int</span> <span class="o">=</span> <span class="n">Ω</span><span class="o">*</span><span class="p">(</span><span class="n">a</span> <span class="n">⊗</span> <span class="n">sp</span> <span class="o">+</span> <span class="n">at</span> <span class="n">⊗</span> <span class="n">sm</span><span class="p">)</span>
</pre></div>
</div>
<p>To extend the single system Hamiltonians <span class="math">\(H_{atom}\)</span> and <span class="math">\(H_{spin}\)</span> to the composite system Hilbert space, one possibility is to combine them with identity operators from the opposite sub-system.</p>
<div class="highlight-julia"><div class="highlight"><pre><span></span><span class="n">I_field</span> <span class="o">=</span> <span class="n">identityoperator</span><span class="p">(</span><span class="n">b_fock</span><span class="p">)</span>
<span class="n">I_atom</span> <span class="o">=</span> <span class="n">identityoperator</span><span class="p">(</span><span class="n">b_spin</span><span class="p">)</span>

<span class="n">H_atom_</span> <span class="o">=</span> <span class="n">I_field</span> <span class="n">⊗</span> <span class="n">H_atom</span>
<span class="n">H_field_</span> <span class="o">=</span> <span class="n">I_atom</span> <span class="n">⊗</span> <span class="n">H_field</span>
</pre></div>
</div>
<p>However, especially for larger systems this can become tedious and it&#8217;s more convenient to use the <a class="reference internal" href="../api.html#embed-db14abf1b0f0c37969c73fa4fb88649d" title="embed()"><code class="xref jl jl-func docutils literal"><span class="pre">embed()</span></code></a> function.</p>
<div class="highlight-julia"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">b_fock</span> <span class="n">⊗</span> <span class="n">b_spin</span> <span class="c"># Basis of composite system</span>

<span class="n">H</span> <span class="o">=</span> <span class="n">embed</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">H_field</span><span class="p">)</span> <span class="o">+</span> <span class="n">embed</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">H_atom</span><span class="p">)</span> <span class="o">+</span> <span class="n">H_int</span>
</pre></div>
</div>
<p>Creating composite states works equivalently.</p>
<div class="highlight-julia"><div class="highlight"><pre><span></span><span class="n">ψ0</span> <span class="o">=</span> <span class="n">fockstate</span><span class="p">(</span><span class="n">b_fock</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="n">⊗</span> <span class="n">spindown</span><span class="p">(</span><span class="n">b_spin</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="time-evolution">
<h2>Time evolution<a class="headerlink" href="#time-evolution" title="Permalink to this headline">¶</a></h2>
<p>Several different types of <a class="reference internal" href="../documentation/timeevolution.html#section-timeevolution"><span class="std std-ref">time evolution</span></a> are implemented in <strong>QuantumOptics.jl</strong>:</p>
<ul class="simple">
<li><a class="reference internal" href="../documentation/timeevolution.html#section-schroedinger"><span class="std std-ref">Schroedinger time evolution</span></a></li>
<li><a class="reference internal" href="../documentation/timeevolution.html#section-master"><span class="std std-ref">Master time evolution</span></a></li>
<li><a class="reference internal" href="../documentation/timeevolution.html#section-mcwf"><span class="std std-ref">MCWF time evolution</span></a></li>
</ul>
<p>All of them share a very similar interface so that changing from one to another is mostly done by exchanging the names:</p>
<div class="highlight-julia"><div class="highlight"><pre><span></span><span class="n">schroedinger</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">psi0</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
<span class="n">master</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">rho0</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">J</span><span class="p">)</span>
<span class="n">mcwf</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">psi0</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">J</span><span class="p">)</span>
</pre></div>
</div>
<p>Let&#8217;s now simulate the dynamics of the system according to the Schrödinger equation.</p>
<div class="highlight-julia"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="o">:</span><span class="mf">0.05</span><span class="o">:</span><span class="mi">5</span><span class="p">;]</span>
<span class="n">tout</span><span class="p">,</span> <span class="n">ψt</span> <span class="o">=</span> <span class="n">timeevolution</span><span class="o">.</span><span class="n">schroedinger</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">ψ0</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
</pre></div>
</div>
<p>Adding photon loss to the cavity by introducing a jump operator <span class="math">\(a\)</span> means that the system is an open quantum system and its time evolution is then described by a master equation.</p>
<div class="highlight-julia"><div class="highlight"><pre><span></span><span class="n">κ</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">J</span> <span class="o">=</span> <span class="p">[</span><span class="n">embed</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="p">)]</span>
<span class="n">tout</span><span class="p">,</span> <span class="n">ρt</span> <span class="o">=</span> <span class="n">timeevolution</span><span class="o">.</span><span class="n">master</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">ψ0</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">J</span><span class="p">;</span> <span class="n">Gamma</span><span class="o">=</span><span class="p">[</span><span class="n">κ</span><span class="p">])</span>
</pre></div>
</div>
<p>Alternatively, one can use the MCWF method to analyze the time evolution of the system. Physically, it can be interpreted as an experimental setup where every photon leaving the cavity is meassured by a photon counter, thereby projecting the system onto the state <span class="math">\(| \psi\rangle \rightarrow a |\psi\rangle\)</span>. This leads to a coherent time evolution according to a Schrödinger equation interrupted by jumps at certain random points in time.</p>
<div class="highlight-julia"><div class="highlight"><pre><span></span><span class="n">tout</span><span class="p">,</span> <span class="n">ψt_mcwf</span> <span class="o">=</span> <span class="n">timeevolution</span><span class="o">.</span><span class="n">mcwf</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">ψ0</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">J</span><span class="p">;</span> <span class="n">seed</span><span class="o">=</span><span class="kt">UInt</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
                                   <span class="n">display_beforeevent</span><span class="o">=</span><span class="kc">true</span><span class="p">,</span>
                                   <span class="n">display_afterevent</span><span class="o">=</span><span class="kc">true</span><span class="p">)</span>
</pre></div>
</div>
<p>The results can be visualized using for example <a class="reference external" href="matplotlib.org">Matplotlib</a> via <a class="reference external" href="https://github.com/JuliaPy/PyPlot.jl">PyPlot.jl</a>.</p>
<div class="highlight-julia"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="n">PyPlot</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Time&quot;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="n">L</span><span class="s">&quot;$\langle |e</span><span class="se">\r</span><span class="s">angle \langle e| </span><span class="se">\r</span><span class="s">angle$&quot;</span><span class="p">)</span>
<span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">expect</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sp</span><span class="o">*</span><span class="n">sm</span><span class="p">,</span> <span class="n">ψt</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;Schrödinger&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">expect</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sp</span><span class="o">*</span><span class="n">sm</span><span class="p">,</span> <span class="n">ρt</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;Master&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span> <span class="n">expect</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sp</span><span class="o">*</span><span class="n">sm</span><span class="p">,</span> <span class="n">ψt_mcwf</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;MCWF&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>

<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Time&quot;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="n">L</span><span class="s">&quot;$\langle n </span><span class="se">\r</span><span class="s">angle$&quot;</span><span class="p">)</span>
<span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">expect</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">ψt</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;Schrödinger&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">expect</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">ρt</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;Master&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span> <span class="n">expect</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">ψt_mcwf</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;MCWF&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
<img alt="../_images/_tutorial_34_0.png" src="../_images/_tutorial_34_0.png" />
<p>In the statistical average the MCWF time evolution is equivalent to the
time evolution according to the master equation.</p>
<div class="highlight-julia"><div class="highlight"><pre><span></span><span class="n">Ntrajectories</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">exp_n</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="kt">Float64</span><span class="p">,</span> <span class="n">length</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>
<span class="n">exp_e</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="kt">Float64</span><span class="p">,</span> <span class="n">length</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>

<span class="k">function</span> <span class="n">fout</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">psi</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">findfirst</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
    <span class="n">exp_e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">real</span><span class="p">(</span><span class="n">expect</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sp</span><span class="o">*</span><span class="n">sm</span><span class="p">,</span> <span class="n">normalize</span><span class="p">(</span><span class="n">psi</span><span class="p">)))</span>
    <span class="n">exp_n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">real</span><span class="p">(</span><span class="n">expect</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">normalize</span><span class="p">(</span><span class="n">psi</span><span class="p">)))</span>
<span class="k">end</span>

<span class="n">srand</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="n">Ntrajectories</span>
    <span class="n">timeevolution</span><span class="o">.</span><span class="n">mcwf</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">ψ0</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">J</span><span class="p">;</span> <span class="n">fout</span><span class="o">=</span><span class="n">fout</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Time&quot;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="n">L</span><span class="s">&quot;$\langle |e</span><span class="se">\r</span><span class="s">angle \langle e| </span><span class="se">\r</span><span class="s">angle$&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">expect</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sp</span><span class="o">*</span><span class="n">sm</span><span class="p">,</span> <span class="n">ρt</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;Master&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">exp_e</span><span class="o">/</span><span class="n">Ntrajectories</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">L</span><span class="s">&quot;$\langle \mathrm{MCWF} </span><span class="se">\r</span><span class="s">angle$&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>

<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Time&quot;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="n">L</span><span class="s">&quot;$\langle n </span><span class="se">\r</span><span class="s">angle$&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">expect</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">ρt</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;Master&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">exp_n</span><span class="o">/</span><span class="n">Ntrajectories</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">L</span><span class="s">&quot;$\langle \mathrm{MCWF} </span><span class="se">\r</span><span class="s">angle$&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
<img alt="../_images/_tutorial_36_0.png" src="../_images/_tutorial_36_0.png" />
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../documentation/documentation.html" class="btn btn-neutral float-right" title="Documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../installation.html" class="btn btn-neutral" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Sebastian Krämer.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>