

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>N-Particles in a double-well potential &mdash; QuantumOptics.jl</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="QuantumOptics.jl" href="../index.html"/>
        <link rel="up" title="Examples" href="../examples.html"/>
        <link rel="next" title="API" href="../api.html"/>
        <link rel="prev" title="Four level system in many-body formalism" href="manybody-fourlevel-system.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  


  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> QuantumOptics.jl
          

          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentation/documentation.html">Documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pumped-cavity.html">Pumped cavity</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaynes-cummings.html">Jaynes-Cummings model</a></li>
<li class="toctree-l2"><a class="reference internal" href="particle-in-harmonic-trap.html">Particle in harmonic trap potential</a></li>
<li class="toctree-l2"><a class="reference internal" href="particle-into-barrier.html">Gaussian wave packet running into a potential barrier</a></li>
<li class="toctree-l2"><a class="reference internal" href="raman.html">Raman Transition of a <span class="math">\(\Lambda\)</span>-scheme Atom</a></li>
<li class="toctree-l2"><a class="reference internal" href="two-qubit-entanglement.html">Entanglement of Two Qubits</a></li>
<li class="toctree-l2"><a class="reference internal" href="correlation-spectrum.html">Two-time correlation function and spectrum of a Fock state</a></li>
<li class="toctree-l2"><a class="reference internal" href="manybody-fourlevel-system.html">Four level system in many-body formalism</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">N-Particles in a double-well potential</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#one-particle-in-a-double-well">One particle in a double-well</a></li>
<li class="toctree-l3"><a class="reference internal" href="#low-energy-subspace">Low energy subspace</a></li>
<li class="toctree-l3"><a class="reference internal" href="#many-body-system">Many-body system</a></li>
<li class="toctree-l3"><a class="reference internal" href="#many-body-system-with-particle-particle-interaction">Many-body system with particle-particle interaction</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">QuantumOptics.jl</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../examples.html">Examples</a> &raquo;</li>
        
      <li>N-Particles in a double-well potential</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/examples/nparticles-in-double-well.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p><em>This notebook can be found on</em>
<a class="reference external" href="https://github.com/bastikr/QuantumOptics.jl/blob/master/examples/nparticles-in-double-well.ipynb">github</a></p>
<div class="section" id="n-particles-in-a-double-well-potential">
<span id="example-nparticles-in-double-well"></span><h1>N-Particles in a double-well potential<a class="headerlink" href="#n-particles-in-a-double-well-potential" title="Permalink to this headline">¶</a></h1>
<p>In this example we will first solve the problem of a single particle in
a double well potential. We then will assume that the particle is always
trapped in one of the low energy states. This allows us to reduce the
Hilbert space of the system to these states only. Using this reduced
Hilbert space we will investigate the case of N indistinguishable
particles in such a system. Finally we will add particle-particle
interaction to obtain a more interesting problem.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="n">QuantumOptics</span>
<span class="k">using</span> <span class="n">PyPlot</span>
</pre></div>
</div>
<div class="section" id="one-particle-in-a-double-well">
<h2>One particle in a double-well<a class="headerlink" href="#one-particle-in-a-double-well" title="Permalink to this headline">¶</a></h2>
<p>First we choose a basis for a single particle, specify the double-well
potential and calculate the Hamiltonian.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">xmin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">Nsteps</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">E0</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">b_position</span> <span class="o">=</span> <span class="n">PositionBasis</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">Nsteps</span><span class="p">)</span>
<span class="n">xpoints</span> <span class="o">=</span> <span class="n">samplepoints</span><span class="p">(</span><span class="n">b_position</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">positionoperator</span><span class="p">(</span><span class="n">b_position</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">momentumoperator</span><span class="p">(</span><span class="n">b_position</span><span class="p">)</span>

<span class="n">potential</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">E0</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">potentialoperator</span><span class="p">(</span><span class="n">b_position</span><span class="p">,</span> <span class="n">potential</span><span class="p">)</span>
<span class="n">Hkin</span> <span class="o">=</span> <span class="n">p</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="n">m</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">Hkin</span> <span class="o">+</span> <span class="n">full</span><span class="p">(</span><span class="n">V</span><span class="p">);</span>
</pre></div>
</div>
<p>We find the lowest energy eigenstates, where instead of <span class="math">\(H\)</span> we
diagonalize <span class="math">\((H + H^\dagger)/2\)</span> to make it truly Hermitian (due to
numerical errors, the operator <span class="math">\(p^2\)</span> is not Hermitian, even though
we know it has to be).</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">E</span><span class="p">,</span> <span class="n">states</span> <span class="o">=</span> <span class="n">eig</span><span class="p">((</span><span class="n">H</span> <span class="o">+</span> <span class="n">dagger</span><span class="p">(</span><span class="n">H</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">:</span><span class="mi">4</span><span class="p">);</span>
<span class="n">println</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-julia"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">7</span>
</pre></div>
</div>
<p>which pairwise have nearly identical energies.</p>
<p>The corresponding states can be illustrated by plotting their respective
probability distributions.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">abs2</span><span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">abs2</span><span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">abs2</span><span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">abs2</span><span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
<span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/nparticles-in-double-well_8_0.png" src="../_images/nparticles-in-double-well_8_0.png" />
<p>It turns out that combining them results in much nicer localized states.
We plot them corresponding to their energies (orange bands in the
potential on the left).</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">localizedstates</span> <span class="o">=</span> <span class="n">Ket</span><span class="p">[(</span><span class="n">states</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">states</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
                      <span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">states</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
                      <span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">states</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
                      <span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">states</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">potential</span><span class="o">.</span><span class="p">(</span><span class="n">xpoints</span><span class="p">))</span>
<span class="k">for</span> <span class="n">state</span> <span class="kp">in</span> <span class="n">localizedstates</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">abs</span><span class="p">(</span><span class="n">expect</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">state</span><span class="p">))</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">xpoints</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="k">end</span><span class="p">]],</span> <span class="p">[</span><span class="n">E</span><span class="p">,</span> <span class="n">E</span><span class="p">],</span> <span class="s">&quot;C1&quot;</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">abs2</span><span class="p">(</span><span class="n">localizedstates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">abs2</span><span class="p">(</span><span class="n">localizedstates</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">abs2</span><span class="p">(</span><span class="n">localizedstates</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">abs2</span><span class="p">(</span><span class="n">localizedstates</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">));</span>
<span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/nparticles-in-double-well_10_0.png" src="../_images/nparticles-in-double-well_10_0.png" />
</div>
<div class="section" id="low-energy-subspace">
<h2>Low energy subspace<a class="headerlink" href="#low-energy-subspace" title="Permalink to this headline">¶</a></h2>
<p>We now assume that the energy in the system is always so low that it
never reaches states besides the lowest four. This makes it possible to
restrict the Hilbert space to the subspace generated by just these
states. To specify the basis of this subspace one can use the
<strong>SubspaceBasis</strong>. It needs to know the basis of the enveloping Hilbert
space <span class="math">\(\mathcal{H}\)</span> and the states <span class="math">\(|u_i\rangle\)</span>, which are
defined in <span class="math">\(\mathcal{H}\)</span>, that form the basis of this subspace.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">b_sub</span> <span class="o">=</span> <span class="n">SubspaceBasis</span><span class="p">(</span><span class="n">b_position</span><span class="p">,</span> <span class="n">localizedstates</span><span class="p">)</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;dim(subspace): &quot;</span><span class="p">,</span> <span class="n">length</span><span class="p">(</span><span class="n">b_sub</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-julia"><div class="highlight"><pre><span></span><span class="n">dim</span><span class="p">(</span><span class="n">subspace</span><span class="p">)</span><span class="o">:</span> <span class="mi">4</span>
</pre></div>
</div>
<p>Projectors can be used to convert states and operators from the
superbasis to the subspace basis and vice versa. As the name already
indicates, states that are not in the subspace are projected into it and
then a basis change is performed.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="n">projector</span><span class="p">(</span><span class="n">b_sub</span><span class="p">,</span> <span class="n">b_position</span><span class="p">)</span>
<span class="n">Pt</span> <span class="o">=</span> <span class="n">dagger</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>

<span class="n">x_sub</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">Pt</span>
<span class="n">Hkin_sub</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="n">Hkin</span><span class="o">*</span><span class="n">Pt</span>
<span class="n">V_sub</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">Pt</span>
<span class="n">H_sub</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="n">H</span><span class="o">*</span><span class="n">Pt</span><span class="p">;</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;dim(H_sub): &quot;</span><span class="p">,</span> <span class="n">length</span><span class="p">(</span><span class="n">H_sub</span><span class="o">.</span><span class="n">basis_l</span><span class="p">),</span> <span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="n">length</span><span class="p">(</span><span class="n">H_sub</span><span class="o">.</span><span class="n">basis_r</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-julia"><div class="highlight"><pre><span></span><span class="n">dim</span><span class="p">(</span><span class="n">H_sub</span><span class="p">)</span><span class="o">:</span> <span class="mi">4</span>
</pre></div>
</div>
<p>As example we can simulate the time evolution of the system in this
subspace. Initially we put the particle into the ground state of the
left well. Over time it starts oscillating between the left and right
well ground states.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="o">:</span><span class="mf">0.1</span><span class="o">:</span><span class="mi">23</span><span class="p">;]</span>
<span class="n">psi0_sub</span> <span class="o">=</span> <span class="n">basisstate</span><span class="p">(</span><span class="n">b_sub</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">tout</span><span class="p">,</span> <span class="n">psi_t</span> <span class="o">=</span> <span class="n">timeevolution</span><span class="o">.</span><span class="n">schroedinger</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">psi0_sub</span><span class="p">,</span> <span class="n">H_sub</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span> <span class="p">[</span><span class="n">abs2</span><span class="p">(</span><span class="n">psi</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">psi</span> <span class="kp">in</span> <span class="n">psi_t</span><span class="p">])</span>
<span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span> <span class="p">[</span><span class="n">abs2</span><span class="p">(</span><span class="n">psi</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">psi</span> <span class="kp">in</span> <span class="n">psi_t</span><span class="p">])</span>

<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="c"># Plot particle probablity distribution in the super Hilbert space.</span>
<span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">abs2</span><span class="p">((</span><span class="n">Pt</span><span class="o">*</span><span class="n">psi_t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">data</span><span class="p">),</span> <span class="s">&quot;k&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="k">end</span><span class="p">])</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mf">0.2</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">plot</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">abs2</span><span class="p">((</span><span class="n">Pt</span><span class="o">*</span><span class="n">psi_t</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">data</span><span class="p">),</span> <span class="s">&quot;C0&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;Initial state&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">abs2</span><span class="p">((</span><span class="n">Pt</span><span class="o">*</span><span class="n">psi_t</span><span class="p">[</span><span class="k">end</span><span class="p">])</span><span class="o">.</span><span class="n">data</span><span class="p">),</span> <span class="s">&quot;C1&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;Final state&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
<img alt="../_images/nparticles-in-double-well_16_0.png" src="../_images/nparticles-in-double-well_16_0.png" />
</div>
<div class="section" id="many-body-system">
<h2>Many-body system<a class="headerlink" href="#many-body-system" title="Permalink to this headline">¶</a></h2>
<p>Starting with this subspace basis consisting of the four lowest trapped
states we build up the corresponding many-body basis. Instead of asking
the question in which state a single particle is, we want to know how
many particles are in each of these four levels. To define the many-body
basis one simply has to specify the associated one-body basis and select
the desired many-body states. For example if we have a system consisting
of two fermions we could generate the relevant occupation states with
the <strong>fermionstates()</strong> function:</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">states</span> <span class="o">=</span> <span class="n">fermionstates</span><span class="p">(</span><span class="n">b_sub</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="kp">in</span> <span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">states</span><span class="p">)</span>
    <span class="n">println</span><span class="p">(</span><span class="s">&quot;</span><span class="si">$i</span><span class="s">: &quot;</span><span class="p">,</span> <span class="n">states</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="highlight-julia"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="o">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="mi">2</span><span class="o">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="mi">3</span><span class="o">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="mi">4</span><span class="o">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="mi">5</span><span class="o">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="mi">6</span><span class="o">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>However, in this case we want two bosons, which can be achieved with the
<strong>bosonstates()</strong> function.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">Nparticles</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">b_mb</span> <span class="o">=</span> <span class="n">ManyBodyBasis</span><span class="p">(</span><span class="n">b_sub</span><span class="p">,</span> <span class="n">bosonstates</span><span class="p">(</span><span class="n">b_sub</span><span class="p">,</span> <span class="n">Nparticles</span><span class="p">));</span>
</pre></div>
</div>
<p>Calculating the many-body operators from the corresponding operators in
the associated one-body subspace basis is straight forward using the
<strong>manybodyoperator()</strong> function. Basically it uses the relation</p>
<div class="math">
\[\tilde{A} = \sum_{st} c_s^\dagger c_t \langle u_s| A |u_t \rangle\]</div>
<p>to convert the one-body operator <span class="math">\(A\)</span> to the many-body operator
<span class="math">\(\tilde{A}\)</span>.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">Hkin_mb</span> <span class="o">=</span> <span class="n">manybodyoperator</span><span class="p">(</span><span class="n">b_mb</span><span class="p">,</span> <span class="n">Hkin_sub</span><span class="p">)</span>
<span class="n">V_mb</span> <span class="o">=</span> <span class="n">manybodyoperator</span><span class="p">(</span><span class="n">b_mb</span><span class="p">,</span> <span class="n">V_sub</span><span class="p">)</span>
<span class="n">H_mb</span> <span class="o">=</span> <span class="n">manybodyoperator</span><span class="p">(</span><span class="n">b_mb</span><span class="p">,</span> <span class="n">H_sub</span><span class="p">);</span>
</pre></div>
</div>
<p>To measure the number of particles in a specific state one has two
possibilities. In the one-body subspace basis this would correspond to
the operator <span class="math">\(|u_i\rangle\langle u_i|\)</span>.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">n1_sub</span> <span class="o">=</span> <span class="n">basisstate</span><span class="p">(</span><span class="n">b_sub</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="n">⊗</span> <span class="n">dagger</span><span class="p">(</span><span class="n">basisstate</span><span class="p">(</span><span class="n">b_sub</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">n1_mb</span> <span class="o">=</span> <span class="n">manybodyoperator</span><span class="p">(</span><span class="n">b_mb</span><span class="p">,</span> <span class="n">sparse</span><span class="p">(</span><span class="n">n1_sub</span><span class="p">));</span>
</pre></div>
</div>
<p>Alternatively, one can use the <strong>number()</strong> function.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">n1_mb</span> <span class="o">=</span> <span class="n">number</span><span class="p">(</span><span class="n">b_mb</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">n2_mb</span> <span class="o">=</span> <span class="n">number</span><span class="p">(</span><span class="n">b_mb</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">n3_mb</span> <span class="o">=</span> <span class="n">number</span><span class="p">(</span><span class="n">b_mb</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">n4_mb</span> <span class="o">=</span> <span class="n">number</span><span class="p">(</span><span class="n">b_mb</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
</pre></div>
</div>
<p>As example we will now simulate the time evolution of this many-body
system. Since the particles aren&#8217;t interacting in any way, the result
is, besides a factor two, identical to the single-body case. Initially
both particles are in the ground state of the left well.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">psi0_mb</span> <span class="o">=</span> <span class="n">basisstate</span><span class="p">(</span><span class="n">b_mb</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">tout</span><span class="p">,</span> <span class="n">psi_t_mb</span> <span class="o">=</span> <span class="n">timeevolution</span><span class="o">.</span><span class="n">schroedinger</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">psi0_mb</span><span class="p">,</span> <span class="n">H_mb</span><span class="p">);</span>
</pre></div>
</div>
<p>To obtain the particle density in the position basis one has to be a
little bit creative. The important observation is that the probability
density at the point <span class="math">\(x_i\)</span> can be calculated by
<span class="math">\(n(x_i) = \langle \Psi| X_i |\Psi\rangle\)</span> where
<span class="math">\(X_i = |x_i\rangle \langle x_i|\)</span>. By first projecting the operator
<span class="math">\(X_i\)</span> into the one-body subspace and then transforming this
operator into its many-body equivalent we can calculate the particle
probability density as expectation value of this many-body operator.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="s">&quot;&quot;&quot;</span>
<span class="s">Sparse operator |x_i&gt;&lt;x_i| in position basis.</span>
<span class="s">&quot;&quot;&quot;</span>
<span class="k">function</span> <span class="n">nx</span><span class="p">(</span><span class="n">b</span><span class="o">::</span><span class="n">PositionBasis</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">op</span> <span class="o">=</span> <span class="n">SparseOperator</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">op</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
    <span class="n">op</span>
<span class="k">end</span>

<span class="s">&quot;&quot;&quot;</span>
<span class="s">Probability density in the position basis of the given many body state.</span>
<span class="s">&quot;&quot;&quot;</span>
<span class="k">function</span> <span class="n">probabilitydensity_x</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="kt">Vector</span><span class="p">{</span><span class="kt">Float64</span><span class="p">}(</span><span class="n">length</span><span class="p">(</span><span class="n">b_position</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">b_position</span><span class="p">)</span>
        <span class="n">nx_i</span> <span class="o">=</span> <span class="n">nx</span><span class="p">(</span><span class="n">b_position</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">nx_i_sub</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="n">nx_i</span><span class="o">*</span><span class="n">Pt</span>
        <span class="n">nx_i_mb</span> <span class="o">=</span> <span class="n">manybodyoperator</span><span class="p">(</span><span class="n">b_mb</span><span class="p">,</span> <span class="n">nx_i_sub</span><span class="p">)</span>
        <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">real</span><span class="p">(</span><span class="n">expect</span><span class="p">(</span><span class="n">nx_i_mb</span><span class="p">,</span> <span class="n">state</span><span class="p">))</span>
    <span class="k">end</span>
    <span class="n">n</span>
<span class="k">end</span><span class="p">;</span>
</pre></div>
</div>
<p>This allows us to reproduce the one-body results.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span> <span class="n">real</span><span class="p">(</span><span class="n">expect</span><span class="p">(</span><span class="n">n1_mb</span><span class="p">,</span> <span class="n">psi_t_mb</span><span class="p">)))</span>
<span class="n">plot</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span> <span class="n">real</span><span class="p">(</span><span class="n">expect</span><span class="p">(</span><span class="n">n2_mb</span><span class="p">,</span> <span class="n">psi_t_mb</span><span class="p">)))</span>

<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">T_</span> <span class="o">=</span> <span class="n">tout</span><span class="p">[</span><span class="n">tout</span><span class="o">.&lt;</span><span class="mi">23</span><span class="p">]</span>
<span class="n">plot</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">real</span><span class="p">(</span><span class="n">probabilitydensity_x</span><span class="p">(</span><span class="n">psi_t_mb</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;Initial state&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">real</span><span class="p">(</span><span class="n">probabilitydensity_x</span><span class="p">(</span><span class="n">psi_t_mb</span><span class="p">[</span><span class="n">length</span><span class="p">(</span><span class="n">T_</span><span class="p">)])),</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;Final state&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
<img alt="../_images/nparticles-in-double-well_32_0.png" src="../_images/nparticles-in-double-well_32_0.png" />
</div>
<div class="section" id="many-body-system-with-particle-particle-interaction">
<h2>Many-body system with particle-particle interaction<a class="headerlink" href="#many-body-system-with-particle-particle-interaction" title="Permalink to this headline">¶</a></h2>
<p>In principle it is possible to include arbitrary particle-particle
interactions. The only limitations is that the dimension of the
interaction operator might get too large. In this case we will use a
Coulomb interaction between the particles. Defining it in the position
basis is straight forward. Note that we cheated a little bit to avoid
infinitely high interaction when both particles are at the same
position.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">b2_position</span> <span class="o">=</span> <span class="n">b_position</span> <span class="n">⊗</span> <span class="n">b_position</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">embed</span><span class="p">(</span><span class="n">b2_position</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">embed</span><span class="p">(</span><span class="n">b2_position</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">abs</span><span class="p">(</span><span class="n">diag</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">data</span><span class="p">))</span><span class="o">.^-</span><span class="mi">1</span>
<span class="n">d</span><span class="p">[</span><span class="n">d</span><span class="o">.==</span><span class="nb">Inf</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">spdiagm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">H_coulomb</span> <span class="o">=</span> <span class="n">SparseOperator</span><span class="p">(</span><span class="n">b2_position</span><span class="p">,</span> <span class="n">b2_position</span><span class="p">,</span> <span class="n">data</span><span class="p">);</span>
</pre></div>
</div>
<p>As before we then project this interaction operator into the chosen
subspace.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">H_coulomb_sub</span> <span class="o">=</span> <span class="p">(</span><span class="n">P⊗P</span><span class="p">)</span><span class="o">*</span><span class="n">H_coulomb</span><span class="o">*</span><span class="p">(</span><span class="n">Pt⊗Pt</span><span class="p">);</span>
</pre></div>
</div>
<p>The <strong>manybodyoperator()</strong> function automatically detects that this is a
two-particle interaction operator and uses the relation</p>
<div class="math">
\[\tilde{A} = \sum_{stkl} c_s^\dagger c_k^\dagger c_t c_l \langle u_s | \langle u_k| A |u_t \rangle |i_l \rangle\]</div>
<p>to calculate the corresponding many-body operator.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">H_coulomb_mb</span> <span class="o">=</span> <span class="n">manybodyoperator</span><span class="p">(</span><span class="n">b_mb</span><span class="p">,</span> <span class="n">H_coulomb_sub</span><span class="p">);</span>
</pre></div>
</div>
<p>We will now calculate the lowest eigenstates for the case of attrictive
and for the case of repulsive interaction.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">E_coulomb_attractive</span><span class="p">,</span> <span class="n">states_coulomb_attractive</span> <span class="o">=</span> <span class="n">eig</span><span class="p">(</span><span class="n">H_mb</span> <span class="o">-</span> <span class="n">H_coulomb_mb</span><span class="p">)</span>
<span class="n">E_coulomb_repulsive</span><span class="p">,</span> <span class="n">states_coulomb_repulsive</span> <span class="o">=</span> <span class="n">eig</span><span class="p">(</span><span class="n">H_mb</span> <span class="o">+</span> <span class="n">H_coulomb_mb</span><span class="p">);</span>
</pre></div>
</div>
<p>It is interesting to see how the particle-particle correlation looks.
For this the same approach as before for the probability density can be
used. In the position basis this correlation can be calculated as
expectation value of the two-particle operator
<span class="math">\(X_1 \otimes X_2 = |x_1 x_2\rangle\langle x_1 x_2|\)</span>. However,
since this turns out to be rather slow at the moment (further
improvements are definitively possible), we will only evaluate this
correlation function at a limited set of points.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="s">&quot;&quot;&quot;</span>
<span class="s">Probability density in the position basis of the given many body state.</span>
<span class="s">&quot;&quot;&quot;</span>
<span class="k">function</span> <span class="n">probabilitydensity_x1x2</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span>
    <span class="n">P2</span> <span class="o">=</span> <span class="n">P</span> <span class="n">⊗</span> <span class="n">P</span>
    <span class="n">P2t</span> <span class="o">=</span> <span class="n">dagger</span><span class="p">(</span><span class="n">P2</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="kt">Matrix</span><span class="p">{</span><span class="kt">Float64</span><span class="p">}(</span><span class="n">length</span><span class="p">(</span><span class="n">indices</span><span class="p">),</span> <span class="n">length</span><span class="p">(</span><span class="n">indices</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
        <span class="n">nx_i_sub</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="n">nx</span><span class="p">(</span><span class="n">b_position</span><span class="p">,</span> <span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">Pt</span>
        <span class="k">for</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
            <span class="n">nx_j_sub</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="n">nx</span><span class="p">(</span><span class="n">b_position</span><span class="p">,</span> <span class="n">indices</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">Pt</span>
            <span class="n">nx_ij_sub</span> <span class="o">=</span> <span class="n">nx_i_sub</span> <span class="n">⊗</span> <span class="n">nx_j_sub</span>
            <span class="n">nx_ij_mb</span> <span class="o">=</span> <span class="n">manybodyoperator</span><span class="p">(</span><span class="n">b_mb</span><span class="p">,</span> <span class="n">nx_ij_sub</span><span class="p">)</span>
            <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">real</span><span class="p">(</span><span class="n">expect</span><span class="p">(</span><span class="n">nx_ij_mb</span><span class="p">,</span> <span class="n">state</span><span class="p">))</span>
        <span class="k">end</span>
    <span class="k">end</span>
    <span class="n">n</span>
<span class="k">end</span><span class="p">;</span>
</pre></div>
</div>
<p>Let&#8217;s first investigate the case of attractive interaction. Looking at
the energy spectrum we see that the lowest energies always come as
pairs.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">println</span><span class="p">(</span><span class="n">abs</span><span class="p">(</span><span class="n">E_coulomb_attractive</span><span class="p">)[</span><span class="mi">1</span><span class="o">:</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-julia"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">2</span>
</pre></div>
</div>
<p>It turns out that superpositions of these pairs results are much nicer
localized states. Unsurprisingly, for the case of attractive interaction
the particles tend to stay in the same positions. (For a nicer
representation of the particle correlation increase the number of
included points and wait...).</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">b_position</span><span class="p">);]</span>

<span class="n">n_attractive1</span> <span class="o">=</span> <span class="n">probabilitydensity_x1x2</span><span class="p">(</span><span class="n">states_coulomb_attractive</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">states_coulomb_attractive</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">indices</span><span class="p">)</span>
<span class="n">n_attractive2</span> <span class="o">=</span> <span class="n">probabilitydensity_x1x2</span><span class="p">(</span><span class="n">states_coulomb_attractive</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">states_coulomb_attractive</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">indices</span><span class="p">)</span>
<span class="n">n_attractive3</span> <span class="o">=</span> <span class="n">probabilitydensity_x1x2</span><span class="p">(</span><span class="n">states_coulomb_attractive</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">states_coulomb_attractive</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">indices</span><span class="p">)</span>
<span class="n">n_attractive4</span> <span class="o">=</span> <span class="n">probabilitydensity_x1x2</span><span class="p">(</span><span class="n">states_coulomb_attractive</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">states_coulomb_attractive</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">indices</span><span class="p">);</span>
</pre></div>
</div>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">pcolor</span><span class="p">(</span><span class="n">n_attractive1</span><span class="p">)</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">pcolor</span><span class="p">(</span><span class="n">n_attractive2</span><span class="p">)</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">pcolor</span><span class="p">(</span><span class="n">n_attractive3</span><span class="p">)</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">pcolor</span><span class="p">(</span><span class="n">n_attractive4</span><span class="p">);</span>
</pre></div>
</div>
<img alt="../_images/nparticles-in-double-well_47_0.png" src="../_images/nparticles-in-double-well_47_0.png" />
<p>The energy spectrum for the case of repulsive interaction is a little
bit different. There exists a single, energywise nicely separated
groundstate. The second and third as well as the fourth ond fifth states
again form pairs with degenerate energies.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">println</span><span class="p">(</span><span class="n">abs</span><span class="p">(</span><span class="n">E_coulomb_repulsive</span><span class="p">)[</span><span class="mi">1</span><span class="o">:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-julia"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mf">16.2501</span><span class="p">,</span><span class="mf">23.2544</span><span class="p">,</span><span class="mf">23.3308</span><span class="p">,</span><span class="mf">26.2483</span><span class="p">,</span><span class="mf">26.2886</span><span class="p">]</span>
</pre></div>
</div>
<p>But also in this case there are no surprises - for repulsive interaction
the particles tend to stay in separated wells.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">b_position</span><span class="p">);]</span>

<span class="n">n_repulsive1</span> <span class="o">=</span> <span class="n">probabilitydensity_x1x2</span><span class="p">(</span><span class="n">states_coulomb_repulsive</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">indices</span><span class="p">)</span>
<span class="n">n_repulsive2</span> <span class="o">=</span> <span class="n">probabilitydensity_x1x2</span><span class="p">(</span><span class="n">states_coulomb_repulsive</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">indices</span><span class="p">)</span>
<span class="n">n_repulsive3</span> <span class="o">=</span> <span class="n">probabilitydensity_x1x2</span><span class="p">(</span><span class="n">states_coulomb_repulsive</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">indices</span><span class="p">);</span>
</pre></div>
</div>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">pcolor</span><span class="p">(</span><span class="n">n_repulsive1</span><span class="p">)</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">pcolor</span><span class="p">(</span><span class="n">n_repulsive2</span><span class="p">)</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">pcolor</span><span class="p">(</span><span class="n">n_repulsive3</span><span class="p">)</span>
<span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
<img alt="../_images/nparticles-in-double-well_52_0.png" src="../_images/nparticles-in-double-well_52_0.png" />
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../api.html" class="btn btn-neutral float-right" title="API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="manybody-fourlevel-system.html" class="btn btn-neutral" title="Four level system in many-body formalism" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Sebastian Krämer.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>