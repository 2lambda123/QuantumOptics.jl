

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Two-time correlation function and spectrum of a Fock state &mdash; QuantumOptics.jl</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="QuantumOptics.jl" href="../index.html"/>
        <link rel="up" title="Examples" href="../examples.html"/>
        <link rel="next" title="Four level system in many-body formalism" href="manybody-fourlevel-system.html"/>
        <link rel="prev" title="Entanglement of Two Qubits" href="two-qubit-entanglement.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  


  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> QuantumOptics.jl
          

          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentation/documentation.html">Documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pumped-cavity.html">Pumped cavity</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaynes-cummings.html">Jaynes-Cummings model</a></li>
<li class="toctree-l2"><a class="reference internal" href="particle-in-harmonic-trap.html">Particle in harmonic trap potential</a></li>
<li class="toctree-l2"><a class="reference internal" href="particle-into-barrier.html">Gaussian wave packet running into a potential barrier</a></li>
<li class="toctree-l2"><a class="reference internal" href="raman.html">Raman Transition of a <span class="math">\(\Lambda\)</span>-scheme Atom</a></li>
<li class="toctree-l2"><a class="reference internal" href="two-qubit-entanglement.html">Entanglement of Two Qubits</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Two-time correlation function and spectrum of a Fock state</a></li>
<li class="toctree-l2"><a class="reference internal" href="manybody-fourlevel-system.html">Four level system in many-body formalism</a></li>
<li class="toctree-l2"><a class="reference internal" href="nparticles-in-double-well.html">N-Particles in a double-well potential</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">QuantumOptics.jl</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../examples.html">Examples</a> &raquo;</li>
        
      <li>Two-time correlation function and spectrum of a Fock state</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/examples/correlation-spectrum.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p><em>This notebook can be found on</em>
<a class="reference external" href="https://github.com/bastikr/QuantumOptics.jl/blob/master/examples/correlation-spectrum.ipynb">github</a></p>
<div class="section" id="two-time-correlation-function-and-spectrum-of-a-fock-state">
<span id="example-correlation-spectrum"></span><h1>Two-time correlation function and spectrum of a Fock state<a class="headerlink" href="#two-time-correlation-function-and-spectrum-of-a-fock-state" title="Permalink to this headline">¶</a></h1>
<p>Consider a Fock state of <span class="math">\(n\)</span> photons inside a damped cavity, that
undergoes the free dynamics. The Hamiltonian is</p>
<p><span class="math">\(H = -\Delta a^\dagger a\)</span>,</p>
<p>while the damping is described by the Lindblad term</p>
<p><span class="math">\(\mathcal{L}[\rho] = \kappa\left(2a\rho a^\dagger - a^\dagger a \rho - \rho a^\dagger a\right)\)</span>.</p>
<p>Here, the detuning
<span class="math">\(\Delta = \omega_\mathrm{r} - \omega_\mathrm{c}\)</span> is the detuning
between the cavity frequency <span class="math">\(\omega_\mathrm{c}\)</span> with respect to
some reference frequency <span class="math">\(\omega_\mathrm{r}\)</span>. We chose this simple
example, since it can be solved analytically. We do this by writing down
the Heisenberg equation of motion for the operator <span class="math">\(a\)</span>,</p>
<p><span class="math">\(\dot{a} = \left(i\Delta - \kappa\right)a\)</span>,</p>
<p>which has the solution</p>
<p><span class="math">\(a(t) = a(0) e^{\left(i\Delta - \kappa\right)t}\)</span>.</p>
<p>Inserting this into the definition of the two-time correlation function,
we find</p>
<p><span class="math">\(g(\tau) = \langle a^\dagger(\tau) a(0)\rangle = \langle a^\dagger(\tau) a(0)\rangle e^{-i\Delta\tau}e^{-\kappa\tau} = n e^{-i\Delta\tau}e^{-\kappa\tau}\)</span>,</p>
<p>where <span class="math">\(n\)</span> is the photon number of the initial state.</p>
<p>Therefore, we find by the Wiener-Khinchin theorem that the spectrum is</p>
<p><span class="math">\(S(\omega) = 2\Re\left\{\int_0^{\infty} d\tau e^{-i\omega\tau}g(\tau) \right\} = 2\Re\left\{\frac{n\left(-i(\omega + \Delta) + \kappa\right)}{\left(\omega + \Delta\right)^2 + \kappa^2}\right\} = \frac{2n\kappa}{(\omega + \Delta)^2 + \kappa^2}\)</span>.</p>
<p>In the following program, we check this result with the implemented
functions in the module timecorrelations.jl</p>
<p>As usual, we start by including the libraries we require. In order to
save us some code typing, we substitute the functions from the
timecorrelations module.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="n">QuantumOptics</span>
<span class="n">correlation</span> <span class="o">=</span> <span class="n">timecorrelations</span><span class="o">.</span><span class="n">correlation</span>
<span class="n">corr2spec</span> <span class="o">=</span> <span class="n">timecorrelations</span><span class="o">.</span><span class="n">correlation2spectrum</span>
<span class="k">using</span> <span class="n">PyPlot</span>
</pre></div>
</div>
<p>Next, we define the necessary parameters. In this example, we use a Fock
state containing <span class="math">\(n=4\)</span> photons.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">Nc</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">κ</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">Δ</span> <span class="o">=</span> <span class="mf">5.0</span><span class="n">κ</span><span class="p">;</span>
</pre></div>
</div>
<p>After defining our basis and the annihilation operator <span class="math">\(a\)</span>, we can
write down the Hamiltonian and the jump operators.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">basis</span> <span class="o">=</span> <span class="n">FockBasis</span><span class="p">(</span><span class="n">Nc</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">destroy</span><span class="p">(</span><span class="n">basis</span><span class="p">)</span>
<span class="n">H</span> <span class="o">=</span> <span class="o">-</span><span class="n">Δ</span><span class="o">*</span><span class="n">dagger</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">a</span>
<span class="n">J</span> <span class="o">=</span> <span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="n">κ</span><span class="p">)</span><span class="o">*</span><span class="n">a</span><span class="p">];</span>
</pre></div>
</div>
<p>Defining the initial density matrix <span class="math">\(\rho_0\)</span> corresponding to the
<span class="math">\(n\)</span> photon Fock state, we can calculate the correlation function
for a list of times <span class="math">\(\tau\)</span>. Note, that in theory, when calculating
the spectrum, the integral goes to infinite times. Obviously, we require
a finite time numerically, but we set it sufficiently large.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">ρ₀</span> <span class="o">=</span> <span class="n">fockstate</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="n">⊗</span> <span class="n">dagger</span><span class="p">(</span><span class="n">fockstate</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

<span class="n">dτ</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">τmax</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">τ</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="o">:</span><span class="n">dτ</span><span class="o">:</span><span class="n">τmax</span><span class="p">;]</span>
<span class="n">corr</span> <span class="o">=</span> <span class="n">correlation</span><span class="p">(</span><span class="n">τ</span><span class="p">,</span> <span class="n">ρ₀</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">dagger</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">a</span><span class="p">);</span>
</pre></div>
</div>
<p>The function timecorrelations.spectrum calculates the correlation
internally by solving the corresponding time evolution. Since we already
calculated the correlation, it is more efficient to use
timecorrelations.correlation2spectrum, which in our shorthand notation
is corr2spec. This function only performs the necessary Fourier
transform.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">ω</span><span class="p">,</span> <span class="n">spec</span> <span class="o">=</span> <span class="n">corr2spec</span><span class="p">(</span><span class="n">τ</span><span class="p">,</span> <span class="n">corr</span><span class="p">;</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">true</span><span class="p">);</span>
</pre></div>
</div>
<p>Finally, we implement the analytical results we obtained in the
beginning.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">corr_an</span> <span class="o">=</span> <span class="n">n</span><span class="o">.*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="nb">im</span><span class="o">*</span><span class="n">Δ</span><span class="o">.*</span><span class="n">τ</span><span class="p">)</span><span class="o">.*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">κ</span><span class="o">.*</span><span class="n">τ</span><span class="p">)</span>
<span class="n">spec_an</span> <span class="o">=</span> <span class="mi">2</span><span class="n">n</span><span class="o">*</span><span class="n">κ</span><span class="o">./</span><span class="p">((</span><span class="n">Δ</span> <span class="o">+</span> <span class="n">ω</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">κ</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="n">spec_an</span> <span class="o">./=</span> <span class="n">maximum</span><span class="p">(</span><span class="n">spec_an</span><span class="p">);</span>
</pre></div>
</div>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">ω</span><span class="p">,</span> <span class="n">spec</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;numerical&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">ω</span><span class="p">,</span> <span class="n">spec_an</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;analytical&quot;</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;freq.&quot;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;spectrum&quot;</span><span class="p">)</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">τ</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="mi">200</span><span class="p">],</span> <span class="n">real</span><span class="p">(</span><span class="n">corr</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="mi">200</span><span class="p">]))</span>
<span class="n">plot</span><span class="p">(</span><span class="n">τ</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="mi">200</span><span class="p">],</span> <span class="n">real</span><span class="p">(</span><span class="n">corr_an</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="mi">200</span><span class="p">]),</span> <span class="n">ls</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;time&quot;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;correlation&quot;</span><span class="p">)</span>
<span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/correlation-spectrum_14_0.png" src="../_images/correlation-spectrum_14_0.png" />
<p>Note, that the discrepancy in the base line of the spectrum stems from
numerical errors, namely the fact that the time- and frequency steps and
also the final time are finite. Reducing <span class="math">\(d\tau\)</span> and increasing
<span class="math">\(\tau\)</span>max reduces the error.</p>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="manybody-fourlevel-system.html" class="btn btn-neutral float-right" title="Four level system in many-body formalism" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="two-qubit-entanglement.html" class="btn btn-neutral" title="Entanglement of Two Qubits" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Sebastian Krämer.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>